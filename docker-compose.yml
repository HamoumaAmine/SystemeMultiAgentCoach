services:
  agent_memory:
    build:
      context: ./services/agent_memory
      dockerfile: Dockerfile
    container_name: agent_memory
    ports:
      - "8003:8003"
    environment:
      - PYTHONUNBUFFERED=1
    networks:
      - smartcoach_net

  agent_mood:
    build:
      context: ./services/agent_mood
      dockerfile: Dockerfile
    container_name: agent_mood
    ports:
      - "8001:8001"
    environment:
      - PYTHONUNBUFFERED=1
      - GROQ_API_KEY=${GROQ_API_KEY}
    networks:
      - smartcoach_net

  agent_cerveau:
    build:
      context: ./services/agent_cerveau
      dockerfile: Dockerfile
    container_name: agent_cerveau
    ports:
      - "8002:8002"
    environment:
      - PYTHONUNBUFFERED=1
      - GROQ_API_KEY=${GROQ_API_KEY}
      - AGENT_MEMORY_URL=http://agent_memory:8003
    depends_on:
      - agent_memory
    networks:
      - smartcoach_net

  agent_manager:
    build:
      context: ./services/agent_manager
      dockerfile: Dockerfile
    container_name: agent_manager
    ports:
      - "8004:8004"
    environment:
      - PYTHONUNBUFFERED=1
      - GROQ_API_KEY=${GROQ_API_KEY}
    networks:
      - smartcoach_net

  orchestrator:
    build:
      context: ./services/orchestrator
    container_name: orchestrator
    ports:
      - "8005:8005"
    environment:
      - PYTHONUNBUFFERED=1
      - AGENT_MANAGER_URL=http://agent_manager:8004/mcp
      - AGENT_MOOD_URL=http://agent_mood:8001/mcp
      - AGENT_CERVEAU_URL=http://agent_cerveau:8002/mcp
      - AGENT_VISION_URL=http://agent_vision:8008/mcp
      - AGENT_KNOWLEDGE_URL=http://agent_knowledge:8007/mcp
    depends_on:
      - agent_manager
      - agent_mood
      - agent_cerveau
      - agent_vision
      - agent_knowledge
      - agent_memory
    volumes:
      - ./services/agent_interface/uploads:/app/uploads   # ðŸ”¥ partage des images
    networks:
      - smartcoach_net

  agent_speech:
    build:
      context: ./services/agent_speech
      dockerfile: Dockerfile
    container_name: agent_speech
    ports:
      - "8006:8006"
    environment:
      - PYTHONUNBUFFERED=1
      - GROQ_API_KEY=${GROQ_API_KEY}
    networks:
      - smartcoach_net

  agent_interface:
    build:
      context: ./services/agent_interface
      dockerfile: Dockerfile
    container_name: agent_interface
    ports:
      - "8000:8000"
    environment:
      - PYTHONUNBUFFERED=1
      - ORCHESTRATOR_URL=http://orchestrator:8005/mcp
      - AGENT_SPEECH_URL=http://agent_speech:8006
    volumes:
      - ./services/agent_interface/uploads:/app/uploads   # ðŸ”¥ dÃ©jÃ  prÃ©sent
    depends_on:
      - orchestrator
      - agent_speech
    networks:
      - smartcoach_net

  agent_vision:
    build:
      context: ./services/agent_vision
      dockerfile: Dockerfile
    container_name: agent_vision
    ports:
      - "8008:8008"
    environment:
      - PYTHONUNBUFFERED=1
      - GROQ_API_KEY=${GROQ_API_KEY}
    volumes:
      - ./services/agent_interface/uploads:/app/uploads   # ðŸ”¥ partage des images
    networks:
      - smartcoach_net

  agent_knowledge:
    build:
      context: ./services/agent_knowledge
      dockerfile: Dockerfile
    container_name: agent_knowledge
    ports:
      - "8007:8007"
    environment:
      - PYTHONUNBUFFERED=1
      - GROQ_API_KEY=${GROQ_API_KEY}
    networks:
      - smartcoach_net

networks:
  smartcoach_net:
    driver: bridge
